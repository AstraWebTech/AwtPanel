import{l as T,j as t,r as g,E as I,_ as A,c as l,o as s,n as m,G as F,d as L,g as u,t as i,F as h,v as q,y as _,C as R,H as N,x as z,I as G,p as H,q as O,B as j,w as P}from"./index-CJeNF4k2.js";import{P as Z}from"./PreLoader-B77qGjXj.js";function ce(c,w=[]){const{request:v}=T(),o={required:a=>!!a||t.global.t("messages.error.required"),password:a=>a.length<8?t.global.t("messages.error.password_length"):/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&\-])[A-Za-z\d@$!%*?&\-]{8,}$/.test(a)?!0:t.global.t("messages.error.password_format"),passwordConfirmation:a=>n.value.find(d=>d.name==="password").value===a||t.global.t("messages.error.passwords_not_match")},y={name:{name:"name",label:t.global.t("parameters.name"),type:"text",placeholder:t.global.t("placeholders.enter.name"),rule:o.required},login:{name:"login",label:t.global.t("parameters.login"),type:"text",placeholder:t.global.t("placeholders.enter.login"),rule:o.required},file:{name:"file",label:t.global.t("parameters.file"),type:"text",placeholder:t.global.t("placeholders.select.file"),rule:o.required},selectBD:{name:"database_id",label:t.global.t("parameters.database"),type:"selectRequest",replace:{value:"id",name:"name"},table:"databases",placeholder:t.global.t("placeholders.select.database"),rule:o.required},selectBDType:{name:"type_id",label:t.global.t("parameters.type_database"),type:"selectRequest",replace:{value:"id",name:"name"},table:"database_types",placeholder:t.global.t("placeholders.select.type_database"),rule:o.required},selectServer:{name:"server_id",label:t.global.t("parameters.server"),type:"selectRequest",replace:{value:"id",name:"name"},table:"servers",placeholder:t.global.t("placeholders.select.server"),rule:o.required},selectGit:{name:"git_id",label:"GIT",type:"selectRequest",placeholder:t.global.t("placeholders.select.git"),replace:{value:"id",name:"url"},table:"gits",rule:o.required},password:{name:"password",label:t.global.t("parameters.password"),type:"password",placeholder:t.global.t("placeholders.enter.password"),rule:o.password},password_confirmation:{name:"password_confirmation",label:t.global.t("parameters.confirm_password"),type:"password",placeholder:t.global.t("placeholders.enter.confirm_password"),rule:o.passwordConfirmation},token:{name:"token",label:t.global.t("parameters.token"),type:"text",placeholder:t.global.t("placeholders.enter.token"),rule:o.required},id:{name:"id",label:"ID",type:"text",placeholder:t.global.t("placeholders.enter.id"),rule:o.required},url:{name:"url",label:"URL",type:"text",placeholder:t.global.t("placeholders.enter.url"),rule:o.required}},p=g(!1),n=g(c.map(a=>{if(y[a.key]){const{name:d,label:k,type:x,placeholder:D,rule:$,table:E,replace:B}=y[a.key],V={name:a.name||d,label:a.label||k,type:a.type||x,code:a.key,placeholder:a.placeholder||D,value:a.value||"",required:!!a.required,isValid:!0,error:a.error||"",rule:a.validate?$:null,options:a.options,id:a.id||Math.random().toString(16).slice(2),touched:!1};return x==="selectRequest"&&(V.options=g([]),v({method:"get",url:"http://localhost:3000/api/list",params:{table:E}}).then(M=>{V.options.value=M.data.data.map(S=>({value:S[B.value],name:S[B.name]}))}).catch(M=>{console.error(t.global.t("messages.error.load_data")+":",M)})),V}return[]}).filter(Boolean)),e=g(w.map(a=>{if(y[a.name]){const{name:d,type:k}=y[a.name];return{name:d,type:k,value:a.value||""}}return[]}).filter(Boolean)),b=()=>{n.value.forEach(a=>{a.value="",a.error="",a.isValid=!0,a.touched=!1}),e.value.forEach(a=>a.value="")},r=a=>{if(a.rule){const d=a.rule(a.value);d===!0?(a.isValid=!0,a.error=""):(a.isValid=!1,a.error=d,p.value=!1)}},U=()=>(p.value=!0,n.value.forEach(a=>r(a)),p.value),C=()=>[...e.value,...n.value].reduce((a,d)=>(a[d.name]=d.value,a),{});return n.value.forEach(a=>{I(a,()=>r(a))}),{fields:n,hiddenFields:e,isValid:p,clearValues:b,validate:U,getFieldsDataToRequest:C}}const f={key:0,class:"errorMessage"},J=["type","name","id"],K={key:0,class:"awtSelect",style:{flex:"1 1 auto"}},Q=["id","disabled","onUpdate:modelValue","required"],W=["value"],X={key:0},Y={key:1,class:"awtSelect"},ee=["id","disabled","onUpdate:modelValue","required"],ae=["value"],te={key:0},re={key:2,class:"awtInput"},le=["id","name","type","onUpdate:modelValue","required","onBlur"],se={key:0},oe={key:3,class:"flex items-center"},ne=["id","onUpdate:modelValue"],ue=["for","innerHTML"],de={__name:"VueForm",props:{fields:{type:Array,required:!0},hiddenFields:{type:Array,required:!1,default:[]},buttonLabel:{type:String,required:!1},error:{type:String,required:!1},isLoading:{type:Boolean,required:!1,default:!1},showOkMessage:{type:Boolean,required:!1,default:!1},errorMessage:{type:String,required:!1}},emits:["submit"],setup(c,{emit:w}){const v=c,o=w,y=p=>{o("submit",p)};return(p,n)=>(s(),l("form",{onSubmit:P(y,["prevent","stop"]),autocomplete:"off"},[v.errorMessage?(s(),l("div",f,[u("small",null,i(v.errorMessage),1)])):m("",!0),c.hiddenFields.length>0?(s(!0),l(h,{key:1},q(c.hiddenFields,(e,b)=>(s(),l("input",{type:e.type,name:e.name,id:e.name+b,hidden:""},null,8,J))),256)):m("",!0),(s(!0),l(h,null,q(c.fields,(e,b)=>(s(),l(h,{key:b},[e.type==="selectRequest"?(s(),l("label",K,[_(u("select",{id:e.id,disabled:e.disabled||e.options?.length===0,"onUpdate:modelValue":r=>e.value=r,required:e.required},[(s(!0),l(h,null,q(e.options,r=>(s(),l("option",{key:r.value,value:r.value},i(r.name),9,W))),128))],8,Q),[[R,e.value]]),u("p",null,i(e.label),1),e.error?(s(),l("small",X,i(e.error),1)):m("",!0)])):e.type==="select"?(s(),l("label",Y,[_(u("select",{id:e.id,disabled:e.disabled||e.options.length===0,"onUpdate:modelValue":r=>e.value=r,required:e.required},[(s(!0),l(h,null,q(e.options,r=>(s(),l("option",{key:r.value,value:r.value},i(r.name),9,ae))),128))],8,ee),[[R,e.value]]),u("p",null,i(e.label),1),e.error?(s(),l("small",te,i(e.error),1)):m("",!0)])):e.type==="text"||e.type==="number"||e.type==="password"?(s(),l("label",re,[_(u("input",{id:e.id,name:e.name,type:e.type,"onUpdate:modelValue":r=>e.value=r,required:e.required,onBlur:r=>e.touched=!0,class:z({invalid:!!e.error&&e.touched}),autocomplete:"off"},null,42,le),[[N,e.value]]),u("p",null,i(e.label),1),e.error?(s(),l("small",se,i(e.error),1)):m("",!0)])):e.type==="radio"||e.type==="checkbox"?(s(),l("div",oe,[_(u("input",{type:"checkbox",id:e.name+b,"onUpdate:modelValue":r=>e.value=r},null,8,ne),[[G,e.value]]),u("label",{for:e.name+b,innerHTML:e.label},null,8,ue)])):m("",!0)],64))),128)),F(p.$slots,"default",{},void 0),p.$slots.buttons?F(p.$slots,"buttons",{key:2},void 0):m("",!0),L(j,{type:"submit",style:{width:"fit-content"},class:"accent"},{default:H(()=>[O(i(c.buttonLabel),1)]),_:1}),c.isLoading?(s(),l(h,{key:3},[n[0]||(n[0]=u("div",{class:"formShadow"},null,-1)),L(Z,{"aria-label":"Loading"})],64)):m("",!0),c.showOkMessage?(s(),l(h,{key:4},[n[1]||(n[1]=u("div",{class:"formShadow"},null,-1)),n[2]||(n[2]=u("div",{class:"okMessage"}," Всё ок! ",-1))],64)):m("",!0)],32))}},me=A(de,[["__scopeId","data-v-bb96087c"]]);export{me as V,ce as u};
